{{- define "main" }}

{{- if .Title }}

{{- end }}

{{- $pages := union .RegularPages .Sections }}
{{- if .IsHome }}
{{- $pages = where site.RegularPages "Type" "in" site.Params.mainSections }}
{{- end }}
{{- $paginator := .Paginate $pages }}

<div class="log-container">
{{- range $paginator.Pages }}

  <div class="log-entry" id="{{ .File.TranslationBaseName }}">
    
    <div class="log-meta">
      <span class="log-date">{{ .Date.Format "2006-01-02" }}</span>
      <button class="copy-link-btn" onclick="copyAnchor('{{ .File.TranslationBaseName }}')" title="Copy Link">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
      </button>
    </div>

    <div class="log-content">
      {{ .Content }}
    </div>

  </div>
  
  <hr class="log-divider">

{{- end }}
</div>
{{- if gt $paginator.TotalPages 1 }}
<footer class="page-footer">
  <nav class="pagination">
    {{- if $paginator.HasPrev }}
    <a class="prev" href="{{ $paginator.Prev.URL | absURL }}">« 前へ</a>
    {{- end }}
    {{- if $paginator.HasNext }}
    <a class="next" href="{{ $paginator.Next.URL | absURL }}">次へ »</a>
    {{- end }}
  </nav>
</footer>
{{- end }}

<script>
function copyAnchor(id) {
    const url = window.location.origin + window.location.pathname + "#" + id;
    navigator.clipboard.writeText(url).then(() => {
        alert("copied: " + url);
    });
}
</script>

{{- end }}